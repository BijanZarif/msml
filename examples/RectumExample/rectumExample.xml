<MSMLScene gravity="0 0 0">
	<object name="liver">
		<physicsElements>
			<materialRegion name="liverMaterial"  >
            <indexGroup indices="@bodyRegion"/>   
				<linearElastic youngModulus="3000" poissonRatio="0.49"/>			
				<mass density="0.6"/>
			</materialRegion>

						
            <mesh>
                <linearTetMesh name="rectumMesh" filename="RectumVolumeWithRegion.vtk" >                   
                </linearTetMesh>
			</mesh>

			<indexGroup name="bodyRegion" indices="@bodyToIndexGroup">
				<boxROIToIndexOperator name="bodyToIndexGroup" box="-124 -315 -1461 84 -146 -1269" mesh="@rectumMesh" select="elements"/>					
			</indexGroup >
			
			<indexGroup name="constraintRegion" indices="@rectumToIndexGroup" >			
                <MaterialIdToIndexOperator name="rectumToIndexGroup" id="1" mesh="@rectumMesh" select="points"/>	
         </indexGroup >
            
		</physicsElements>
      
      <simulationSteps>
         <step name="initial" dt="0.05" timesteps="100" >
           <constraintRegion name="rectumFixedConstraints">
            <indexGroup indices="@constraintRegion"/>   
				<fixedConstraints name="rectumBottom" />			
			  </constraintRegion>
           <constraintRegion name="rectumDispConstraints">
            <indexGroup indices="875"/>   
				<displacementConstraints name="rectumDisp" displacements="-7.17531 -50.405 52.34" />			
			  </constraintRegion>
           
         </step>      
      </simulationSteps>
      
   <postProcessing>
      <displacementOutputRequest name="RectumDef" timestep="1"/>
   </postProcessing>

	</object>
   
   <solver>
      <timeIntegration>dynamicImplicitEuler</timeIntegration>
      <linearSolver>iterativeCG</linearSolver>
      <processingUnit>CPU</processingUnit>
   </solver>
   

   
</MSMLScene>
