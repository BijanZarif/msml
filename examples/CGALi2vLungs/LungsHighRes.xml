<MSMLScene gravity="0">
	<object name="pat">
		<physicsElements>
			<materialRegion name="patMaterial01"  >
                <indexGroup indices="@lung1"/>   
				<linearElastic youngModulus="100" poissonRatio="0.4"/>			
				<mass density="0.001"/>
			</materialRegion>
			<materialRegion name="patMaterial02"  >
                <indexGroup indices="@lung2"/>   
				<linearElastic youngModulus="100" poissonRatio="0.4"/>			
				<mass density="0.001"/>
			</materialRegion>
			<materialRegion name="patMaterial02"  >
                <indexGroup indices="@bones"/>   
				<linearElastic youngModulus="19000" poissonRatio="0.4"/>			
				<mass density="0.001"/>
			</materialRegion>
			<materialRegion name="patMaterial03"  >
                <indexGroup indices="@body"/>   
				<linearElastic youngModulus="5" poissonRatio="0.4"/>			
				<mass density="0.001"/>
			</materialRegion>			
						
            <mesh>
			    <linearTetMesh name="ComboMesh" filename="@ComboMesher" >
                    <surfaceExtract name="ComboMesher" meshIn="@VolumeMesh" meshOut="case1_T00_labled_combo.vtk" />
                </linearTetMesh>
                <linearTetMesh name="VolumeMesh" filename="@VolumeMesher" >
                    <mesherCGALi2v name="VolumeMesher" mesh="case1_T00_labled_volume.vtk" image="case1_T00_labled.vti" 
					facet_angle="20" facet_size="4" facet_distance="3" cell_radius_edge_ratio="3" cell_size="10" odt="false" llyod="false"  pertube="false" exude="false" />
                </linearTetMesh>
			</mesh>

			<indexGroup name="body" indices="@bodyToIndexGroup">
				<MaterialIdToIndexOperator name="bodyToIndexGroup"  id="100" mesh="@ComboMesh" select="elements"/>					
			</indexGroup >
			<indexGroup name="bones" indices="@bonesToIndexGroup">
				<MaterialIdToIndexOperator name="bonesToIndexGroup" id="25" mesh="@ComboMesh" select="elements"/>	
			</indexGroup >
			<indexGroup name="lung1" indices="@lung1ToIndexGroup">
				<MaterialIdToIndexOperator name="lung1ToIndexGroup" id="50" mesh="@ComboMesh" select="elements"/>					
			</indexGroup >
			<indexGroup name="lung2" indices="@lung2ToIndexGroup">
				<MaterialIdToIndexOperator name="lung2ToIndexGroup" id="75" mesh="@ComboMesh" select="elements"/>					
			</indexGroup >
			
			<indexGroup name="constraintRegion" indices="@constraintIndexGroup" >			
                <boxROIToIndexOperator name="constraintIndexGroup" box="-1 190 -1 500 230 500" mesh="@ComboMesh" select="points"/>
            </indexGroup >
            
			<indexGroup name="pressureFaces1" indices="@pressure1IndexGroup" >			
                <MaterialIdToIndexOperator name="pressure1IndexGroup" id="75" mesh="@ComboMesh" select="faces"/>
            </indexGroup >
			
			<indexGroup name="pressureFaces2" indices="@pressure2IndexGroup" >			
                <MaterialIdToIndexOperator name="pressure2IndexGroup" id="50" mesh="@ComboMesh" select="faces"/>
            </indexGroup >
			
		</physicsElements>
      
      <simulationSteps>
         <step name="initial" dt="0.05" timesteps="1000" >
            <constraintRegion name="patConstraints">
               <indexGroup indices="@constraintRegion"/>   
				<fixedConstraints name="patBottom" />			
			</constraintRegion>
			 <constraintRegion name="patConstraints">
               <indexGroup indices="@pressureFaces1"/>   
				<surfacePressure name="patBottom" pressure="50"/>			
			</constraintRegion>
			<constraintRegion name="patConstraints">
               <indexGroup indices="@pressureFaces2"/>   
				<surfacePressure name="patBottom" pressure="50"/>			
			</constraintRegion>
         </step>      
      </simulationSteps>
      
   <postProcessing>
      <displacementOutputRequest name="dispOutput" timestep="1"/>
   </postProcessing>

	</object>
   
   <solver>
      <timeIntegration>dynamicImplicitEuler</timeIntegration>
      <linearSolver>iterativeCG</linearSolver>
      <processingUnit>GPU</processingUnit>
   </solver>
   

   
</MSMLScene>
