<msml:msml xmlns:msml="http://sfb125.de/msml"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://sfb125.de/msml">

  <variables>
    <var name="segementation_voxel_image_skin" value="SKIN_1_Contour_IndexedLabelmap.vti" logical="linearMesh" physical="file.vtk"/>

    <var name="tet_only_mesh" value="tet_only_mesh.vtk" logical="linearMesh" physical="str" />

    <var name="GTV_1_mesh" value="GTV_1_mesh.vtk" physical="str" />
    <var name="PTV_1_mesh" value="PTV_1_mesh.vtk" physical="str" />
    <var name="BRAC_PLX_1_mesh" value="BRAC_PLX_1_mesh.vtk" physical="str" />
    <var name="Spinal_1_mesh" value="Spinal_1_mesh.vtk" physical="str" />

    <var name="GTV_1_volmesh" value="GTV_1_volmesh.vtk" physical="str" />
    <var name="PTV_1_volmesh" value="PTV_1_volmesh.vtk" physical="str" />
    <var name="BRAC_PLX_1_volmesh" value="BRAC_PLX_1_volmesh.vtk" physical="str" />
    <var name="Spinal_1_volmesh" value="Spinal_1_volmesh.vtk" physical="str" />
    
    <var name="GTV_1_voxel" value="GTV_1_voxel.vti" logical="str" />
    <var name="PTV_1_voxel" value="PTV_1_voxel.vti" logical="str" />
    <var name="BRAC_PLX_1_voxel" value="BRAC_PLX_1_voxel.vti" logical="str" />
    <var name="Spinal_1_voxel" value="Spinal_1_voxel.vti" logical="str" />
    <var name="BRAC_PLX_1_voxel_nearPTV" value="BRAC_PLX_1_voxel_nearPTV.vti" logical="str" />
    <var name="Spinal_1_voxel_nearPTV" value="Spinal_1_voxel_nearPTV.vti" logical="str" />
    
        
    <!--<var name="CTV_1_distance" value="CTV_1_distance.vtk" logical="str" />
    <var name="CTV_2_distance" value="CTV_2_distance.vtk" logical="str" />
    <var name="HIRNSTAMM_distance" value="HIRNSTAMM_distance.vtk" logical="str" />
    <var name="RUECKENMARK_distance" value="RUECKENMARK_distance.vtk" logical="str" />
    <var name="HIRNSTAMM_distance_nearCTV2" value="HIRNSTAMM_voxel_nearCTV2.vtk" logical="str" />
    <var name="RUECKENMARK_distance_nearCTV2" value="RUECKENMARK_voxel_nearCTV2.vtk" logical="str" />-->
    
  </variables>


  <workflow>
    
    <CGALMeshVolumeFromVoxels id="VolumeMesh" meshFilename="${tet_only_mesh}" image="${segementation_voxel_image_skin}" facetAngle="20" facetSize="10" facetDistance="5" cellRadiusEdgeRatio="3" cellSize="10" odt="false" lloyd="false"  pertube="false" exude="false" />
    <CGALMeshVolumeFromVoxels id="GTV_1_volmeshID" meshFilename="${GTV_1_volmesh}" image="GTV_1_Contour_IndexedLabelmap.vti" facetAngle="20" facetSize="3" facetDistance="2" cellRadiusEdgeRatio="3" cellSize="10" />
    <CGALMeshVolumeFromVoxels id="PTV_1_volmeshID" meshFilename="${PTV_1_volmesh}" image="1cmptv_1_Contour_IndexedLabelmap.vti" facetAngle="20" facetSize="3" facetDistance="2" cellRadiusEdgeRatio="3" cellSize="10" />
    <CGALMeshVolumeFromVoxels id="BRAC_PLX_1_volmeshID" meshFilename="${BRAC_PLX_1_volmesh}" image="BRAC_PLX_1_Contour_IndexedLabelmap.vti" facetAngle="20" facetSize="3" facetDistance="2" cellRadiusEdgeRatio="3" cellSize="10" />
    <CGALMeshVolumeFromVoxels id="Spinal_1_volmeshID" meshFilename="${Spinal_1_volmesh}" image="SPINAL_CORD_1_Contour_IndexedLabelmap.vti" facetAngle="20" facetSize="3" facetDistance="2" cellRadiusEdgeRatio="3" cellSize="10" />
    
    <ExtractSurfaceMesh id="surfaceExtract1" mesh="${GTV_1_volmeshID}" targetSurfaceMeshFilename="${GTV_1_mesh}.vtk"/>
    <ExtractSurfaceMesh id="surfaceExtract2" mesh="${PTV_1_volmeshID}" targetSurfaceMeshFilename="${PTV_1_mesh}.vtk"/>
    <ExtractSurfaceMesh id="surfaceExtract3" mesh="${BRAC_PLX_1_volmeshID}" targetSurfaceMeshFilename="${BRAC_PLX_1_mesh}.vtk"/>
    <ExtractSurfaceMesh id="surfaceExtract4" mesh="${Spinal_1_volmeshID}" targetSurfaceMeshFilename="${Spinal_1_mesh}.vtk"/>
    
    <!--
    <GenerateDistanceMap id="aGenerateDistanceMap1" volumeMesh="${CTV_1_volmeshID}" targetImageFilename="${CTV_1_distance}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" />
    <GenerateDistanceMap id="aGenerateDistanceMap2" volumeMesh="${CTV_2_volmeshID}" targetImageFilename="${CTV_2_distance}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" />
    <GenerateDistanceMap id="aGenerateDistanceMap3" volumeMesh="${HIRNSTAMM_volmeshID}" targetImageFilename="${HIRNSTAMM_distance}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" />
    <GenerateDistanceMap id="aGenerateDistanceMap4" volumeMesh="${RUECKENMARK_volmeshID}" targetImageFilename="${RUECKENMARK_distance}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" />
    <GenerateDistanceMap id="aGenerateDistanceMap5" volumeMesh="${RUECKENMARK_volmeshID}" targetImageFilename="${RUECKENMARK_distance_nearCTV2}" referenceCoordinateGrid="${VoxelizeSurfaceMeshr2}" />
    <GenerateDistanceMap id="aGenerateDistanceMap6" volumeMesh="${HIRNSTAMM_volmeshID}" targetImageFilename="${HIRNSTAMM_distance_nearCTV2}" referenceCoordinateGrid="${VoxelizeSurfaceMeshr2}" />-->
    
    
    <VoxelizeSurfaceMesh id="VoxelizeSurfaceMeshr" surfaceMesh="${surfaceExtract1}" targetImageFilename="${GTV_1_voxel}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" disableFillHoles="true" />
    <VoxelizeSurfaceMesh id="VoxelizeSurfaceMeshr2" surfaceMesh="${surfaceExtract2}" targetImageFilename="${PTV_1_voxel}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" disableFillHoles="true" />
    <VoxelizeSurfaceMesh id="VoxelizeSurfaceMeshr3" surfaceMesh="${surfaceExtract3}" targetImageFilename="${BRAC_PLX_1_voxel}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" disableFillHoles="true" />
    <VoxelizeSurfaceMesh id="VoxelizeSurfaceMeshr4" surfaceMesh="${surfaceExtract4}" targetImageFilename="${Spinal_1_voxel}" isotropicVoxelSize="1.0" additionalIsotropicMargin="50" disableFillHoles="true" />
    
    <VoxelizeSurfaceMesh id="VoxelizeSurfaceMeshr5" surfaceMesh="${surfaceExtract3}" targetImageFilename="${BRAC_PLX_1_voxel_nearPTV}" referenceCoordinateGrid="${VoxelizeSurfaceMeshr2}" disableFillHoles="true" />
    <VoxelizeSurfaceMesh id="VoxelizeSurfaceMeshr6" surfaceMesh="${surfaceExtract4}" targetImageFilename="${Spinal_1_voxel_nearPTV}" referenceCoordinateGrid="${VoxelizeSurfaceMeshr2}" disableFillHoles="true" />


  </workflow>
  
    <environment>
    <solver linearSolver="iterativeCG" processingUnit="GPU"
                timeIntegration="dynamicImplicitEuler"/>
    <simulation>
      <step id="initial" dt="0.05" iterations="200"/>
    </simulation>
  </environment>


</msml:msml>




